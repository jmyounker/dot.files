#!/bin/bash

if [ $# -eq 0 ]; then
   cat <<EOUSAGE
options include:
   down - git pull
   pom - git pull origin master
   pm - git pull origin master
   sclone - clone from github ala soundcloud
   slave - create branch from master ala soundcloud
   t - tig status
   up - git push
EOUSAGE
    exit 127
fi

cmd=$1
shift
case $cmd in
  start)
    if [ $# -ne 1 ]; then
      echo "usage: $0 start NEW_BRANCH_NAME"
      return 127
    fi
    git checkout master
    git pull origin master
    git branch $1
    git checkout $1
    git pull origin master
    ;;

  sclone)
    if [ $# -ne 1 ]; then
      echo "usage: $0 sclone GITHUB_BRANCH_NAME"
      return 127
    fi
    gitpath="git@github.com:soundcloud/shibboleth"
    relpath="src/github.com/soundcloud/$1"
    projroot="$HOME/dev"

    if [ -d "$projroot/$relpath" ]; then
        echo "Project $1 already exists"
        return 0
    fi
    cd $projroot
    git clone $gitpath $relpath
    cd $projroot/$relpath
    projtool init
    ;;

  t)
    tig status
    ;;

  pm|pom)
    git pull origin master
    ;;

  down)
    git pull
    ;;

  up)
    git push
    ;;

  *)
    git $cmd "$@"
    ;;
esac


